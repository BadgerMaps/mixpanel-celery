#!/bin/bash

# Taken from Celery (http://github.com/ask/celery)
# Written by Ask Solem Hoel <askh@opera.com>

git checkout master
(cd docs;
    rm -rf .build;
    make html;
    (cd .build/html;
        sphinxtogithub .;))
git checkout gh-pages
cp -r docs/.build/html/* .
mkdir --parents reference
cp -r docs/.build/html/reference/* reference/
git commit . reference/ -m "Autogenerated documentation for github."
git push --all
git checkout master